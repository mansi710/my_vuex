{"ast":null,"code":"import shop from \"@/store/shop\";\nexport default {\n  namespaced: true,\n  state: {\n    // {id, quantity}\n    items: [],\n    checkoutStatus: null\n  },\n  getters: {\n    cartProducts(state, rootGetters) {\n      console.log(JSON.stringify(state.items));\n      return state.items.map(cartItem => {\n        const product = rootState.availableProducts.find(product => product.id === cartItem.id);\n        return {\n          title: product.title,\n          price: product.price,\n          quantity: cartItem.quantity\n        };\n      });\n    },\n\n    cartTotal(state, getters) {\n      return getters.cartProducts.reduce((total, product) => total + product.price * product.quantity, 0);\n    }\n\n  },\n  mutations: {\n    pushProductToCart(state, productId) {\n      state.items.push({\n        id: productId,\n        quantity: 1\n      });\n    },\n\n    incrementItemQuantity(state, cartItem) {\n      cartItem.quantity++;\n    },\n\n    setCheckoutStatus(state, status) {\n      state.checkoutStatus = status;\n    },\n\n    emptyCart(state) {\n      state.items = [];\n    }\n\n  },\n  actions: {\n    addProductToCart({\n      state,\n      commit,\n      rootGetters\n    }, product) {\n      if (rootGetters[\"products/productIsInStock\"](product)) {\n        const cartItem = state.items.find(item => item.id === product.id);\n\n        if (!cartItem) {\n          commit(\"pushProductToCart\", product.id);\n        } else {\n          commit(\"incrementItemQuantity\", cartItem);\n        }\n\n        commit(\"products/decrementProductInventory\", product, {\n          root: true\n        });\n      }\n    },\n\n    checkout({\n      state,\n      commit\n    }) {\n      shop.buyProducts(state.items, () => {\n        commit(\"emptyCart\");\n        commit(\"setCheckoutStatus\", \"success\");\n      }, () => {\n        commit(\"setCheckoutStatus\", \"fail\");\n      });\n    }\n\n  }\n};","map":{"version":3,"names":["shop","namespaced","state","items","checkoutStatus","getters","cartProducts","rootGetters","console","log","JSON","stringify","map","cartItem","product","rootState","availableProducts","find","id","title","price","quantity","cartTotal","reduce","total","mutations","pushProductToCart","productId","push","incrementItemQuantity","setCheckoutStatus","status","emptyCart","actions","addProductToCart","commit","item","root","checkout","buyProducts"],"sources":["/var/www/html/newData/mansi/vuex/src/store/modules/cart.js"],"sourcesContent":["import shop from \"@/store/shop\";\n\nexport default {\n  namespaced: true,\n\n  state: {\n    // {id, quantity}\n    items: [],\n    checkoutStatus: null,\n  },\n\n  getters: {\n    cartProducts(state, rootGetters) {\n      console.log(JSON.stringify(state.items));\n      return state.items.map((cartItem) => {\n        const product = rootState.availableProducts.find(\n          (product) => product.id === cartItem.id\n        );\n        return {\n          title: product.title,\n          price: product.price,\n          quantity: cartItem.quantity,\n        };\n      });\n    },\n\n    cartTotal(state, getters) {\n      return getters.cartProducts.reduce(\n        (total, product) => total + product.price * product.quantity,\n        0\n      );\n    },\n  },\n\n  mutations: {\n    pushProductToCart(state, productId) {\n      state.items.push({\n        id: productId,\n        quantity: 1,\n      });\n    },\n\n    incrementItemQuantity(state, cartItem) {\n      cartItem.quantity++;\n    },\n\n    setCheckoutStatus(state, status) {\n      state.checkoutStatus = status;\n    },\n\n    emptyCart(state) {\n      state.items = [];\n    },\n  },\n\n  actions: {\n    addProductToCart({ state, commit, rootGetters }, product) {\n      if (rootGetters[\"products/productIsInStock\"](product)) {\n        const cartItem = state.items.find((item) => item.id === product.id);\n        if (!cartItem) {\n          commit(\"pushProductToCart\", product.id);\n        } else {\n          commit(\"incrementItemQuantity\", cartItem);\n        }\n        commit(\"products/decrementProductInventory\", product, { root: true });\n      }\n    },\n\n    checkout({ state, commit }) {\n      shop.buyProducts(\n        state.items,\n        () => {\n          commit(\"emptyCart\");\n          commit(\"setCheckoutStatus\", \"success\");\n        },\n        () => {\n          commit(\"setCheckoutStatus\", \"fail\");\n        }\n      );\n    },\n  },\n};\n"],"mappings":"AAAA,OAAOA,IAAP,MAAiB,cAAjB;AAEA,eAAe;EACbC,UAAU,EAAE,IADC;EAGbC,KAAK,EAAE;IACL;IACAC,KAAK,EAAE,EAFF;IAGLC,cAAc,EAAE;EAHX,CAHM;EASbC,OAAO,EAAE;IACPC,YAAY,CAACJ,KAAD,EAAQK,WAAR,EAAqB;MAC/BC,OAAO,CAACC,GAAR,CAAYC,IAAI,CAACC,SAAL,CAAeT,KAAK,CAACC,KAArB,CAAZ;MACA,OAAOD,KAAK,CAACC,KAAN,CAAYS,GAAZ,CAAiBC,QAAD,IAAc;QACnC,MAAMC,OAAO,GAAGC,SAAS,CAACC,iBAAV,CAA4BC,IAA5B,CACbH,OAAD,IAAaA,OAAO,CAACI,EAAR,KAAeL,QAAQ,CAACK,EADvB,CAAhB;QAGA,OAAO;UACLC,KAAK,EAAEL,OAAO,CAACK,KADV;UAELC,KAAK,EAAEN,OAAO,CAACM,KAFV;UAGLC,QAAQ,EAAER,QAAQ,CAACQ;QAHd,CAAP;MAKD,CATM,CAAP;IAUD,CAbM;;IAePC,SAAS,CAACpB,KAAD,EAAQG,OAAR,EAAiB;MACxB,OAAOA,OAAO,CAACC,YAAR,CAAqBiB,MAArB,CACL,CAACC,KAAD,EAAQV,OAAR,KAAoBU,KAAK,GAAGV,OAAO,CAACM,KAAR,GAAgBN,OAAO,CAACO,QAD/C,EAEL,CAFK,CAAP;IAID;;EApBM,CATI;EAgCbI,SAAS,EAAE;IACTC,iBAAiB,CAACxB,KAAD,EAAQyB,SAAR,EAAmB;MAClCzB,KAAK,CAACC,KAAN,CAAYyB,IAAZ,CAAiB;QACfV,EAAE,EAAES,SADW;QAEfN,QAAQ,EAAE;MAFK,CAAjB;IAID,CANQ;;IAQTQ,qBAAqB,CAAC3B,KAAD,EAAQW,QAAR,EAAkB;MACrCA,QAAQ,CAACQ,QAAT;IACD,CAVQ;;IAYTS,iBAAiB,CAAC5B,KAAD,EAAQ6B,MAAR,EAAgB;MAC/B7B,KAAK,CAACE,cAAN,GAAuB2B,MAAvB;IACD,CAdQ;;IAgBTC,SAAS,CAAC9B,KAAD,EAAQ;MACfA,KAAK,CAACC,KAAN,GAAc,EAAd;IACD;;EAlBQ,CAhCE;EAqDb8B,OAAO,EAAE;IACPC,gBAAgB,CAAC;MAAEhC,KAAF;MAASiC,MAAT;MAAiB5B;IAAjB,CAAD,EAAiCO,OAAjC,EAA0C;MACxD,IAAIP,WAAW,CAAC,2BAAD,CAAX,CAAyCO,OAAzC,CAAJ,EAAuD;QACrD,MAAMD,QAAQ,GAAGX,KAAK,CAACC,KAAN,CAAYc,IAAZ,CAAkBmB,IAAD,IAAUA,IAAI,CAAClB,EAAL,KAAYJ,OAAO,CAACI,EAA/C,CAAjB;;QACA,IAAI,CAACL,QAAL,EAAe;UACbsB,MAAM,CAAC,mBAAD,EAAsBrB,OAAO,CAACI,EAA9B,CAAN;QACD,CAFD,MAEO;UACLiB,MAAM,CAAC,uBAAD,EAA0BtB,QAA1B,CAAN;QACD;;QACDsB,MAAM,CAAC,oCAAD,EAAuCrB,OAAvC,EAAgD;UAAEuB,IAAI,EAAE;QAAR,CAAhD,CAAN;MACD;IACF,CAXM;;IAaPC,QAAQ,CAAC;MAAEpC,KAAF;MAASiC;IAAT,CAAD,EAAoB;MAC1BnC,IAAI,CAACuC,WAAL,CACErC,KAAK,CAACC,KADR,EAEE,MAAM;QACJgC,MAAM,CAAC,WAAD,CAAN;QACAA,MAAM,CAAC,mBAAD,EAAsB,SAAtB,CAAN;MACD,CALH,EAME,MAAM;QACJA,MAAM,CAAC,mBAAD,EAAsB,MAAtB,CAAN;MACD,CARH;IAUD;;EAxBM;AArDI,CAAf"},"metadata":{},"sourceType":"module"}